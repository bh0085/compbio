.TH HYBRID-PLOT 1 "May 2010" "UNAFold 3.8" "User Commands"
.SH NAME
hybrid-plot, hybrid-plot-ng \- plot base pair probabilities
.SH SYNOPSIS
.B hybrid-plot
.RI [ OPTION ]...
.I PREFIX
.br
.B hybrid-plot-ng
.RI [ OPTION ]...
.I PREFIX
.SH DESCRIPTION
\fBhybrid-plot\fR and \fBhybrid-plot-ng\fR display plots of base pair probabilities generated with \fBhybrid\fR or \fBhybrid-ss\fR.  \fBhybrid-plot\fR is an interactive plotting program that uses glut and OpenGL, while \fBhybrid-plot-ng\fR is a command-line program that produces output in PNG or Postscript form.  In either case, a grid is displayed where the size of the dot at (i, j) indicates the likelihood that base i pairs with base j.  (For plots generated by hybrid, i indexes the first sequence and j the second.)  \fIPREFIX\fR specifies the sequence(s) that have been hybridized or folded and the \fI.plot\fR files to display.
.P
The length of a side is increased from the length of the longer sequence to a round number, using the "four fifths rule": the length of a side is the smallest multiple of the largest power of 10 so that the length of the longer sequence is at least four fifths of the length of the side.  For example, if the longer sequence is 873 characters long the plot will be 1000 by 1000; if the longer sequence is 773 characters long the plot will be 800 by 800.
.P
In the plot and zoom windows of \fBhybrid-plot\fR, the left mouse button selects a pair.  The indices and bases of the selected pair are displayed at the bottom of the window along with the probability of the selected pairing.
.P
The middle mouse button is used to zoom.  Dragging out a selection causes the zoom window to appear and display the selected area.  The zoom area is square and snaps to the nearest pair.
.P
The right mouse button displays a menu that can be used to toggle the zoom window, choose a temperature for which to plot, set a cutoff or end the program.  (Setting a cutoff prevents pairs with probabilities below the cutoff from being displayed.)  The menu is also used to select color modes.
.SH COLORS
\fBhybrid-plot\fR and \fBhybrid-plot-ng\fR display points in colors corresponding to the probability of the base pair: red indicates the most likely pairs and magenta the least likely.  When the color mode is set to "linear", the range [0, 1] is divided linearly into 26 subintervals and each is assigned to a color.  When the color mode is set to "logarithmic", the range (epsilon, 1] is divided logarithmically into 25 subintervals and each is assigned to a color.  ([0, epsilon] is the 26th interval.)  This has the effect of emphasizing the distinctions between low-probability base pairs.  Finally, when the color mode is set to "double logarithmic", the intervals [0, epsilon] and [1-epsilon, 1] correspond to pure magenta and pure red, respectively.  The other 24 colors are arranged proportionally to log(2p) when p <= 0.5 and to -log(2-2p) when p > 0.5.  This has the effect of emphasizing the distinctions among very low-probability base pairs and very high-probability base pairs.  For the latter two cases, the value of epsilon can be set by the user.
.SH OPTIONS
With the exception of \fB--grid\fR, the options below apply only to \fBhybrid-plot-ng\fR; \fBhybrid-plot\fR uses a menu-driven interface to change parameters.
.TP
.BR -t ", " --temperature =\fIvalue
plots probabilities at \fIvalue\fR degrees Celsius.  \fIPREFIX.value.plot\fR must exist.
.TP
.BR -c ", " --colors =linear|log|double
sets the method of assigning colors to basepairs to linear, logarithmic or double logarithmic.  Default is double.
.TP
.BR -e ", " --epsilon =\fIvalue
sets epsilon (for logarithmic or double logarithmic colors) to \fIvalue\fR.  Default is 0.01.
.TP
.BR -g ", " --grid =\fIvalue
displays grid lines every \fIvalue\fR base.  A value of 0 turns off the grid.  Default is a reasonable value for the size of the plot.
.TP
.BR -d ", " --dot =\fIsize
sets (maximum) dot size to \fIsize\fR.  Default is a reasonable value for the size of the plot.
.TP
.BR -u ", " --top =\fIi
sets the upper edge of the plot to base \fIi\fR.  Default is 1.
.TP
.BR -l ", " --left =\fIj
sets the left edge of the plot to base \fIj\fR.  Default is 1.
.TP
.BR -s ", " --size =\fIvalue
sets the size of the square to be displayed top \fIvalue\fR.  By combining \fB--top\fR, \fB--left\fR and \fB--size\fR, it is possible to "zoom in" on any area of the plot.
.TP
.BR -f ", " --format =png|ps
sets the output format to PNG or Postscript.  Default is Postscript.
.TP
.BR -i ", " --i =\fIvalue
in conjunction with \fB--j\fR, chooses a basepair to appear selected, as though it were clicked in \fBhybrid-plot\fR.
.TP
.BR -j ", " --j =\fIvalue
in conjunction with \fB--i\fR, chooses a basepair to appear selected, as though it were clicked in \fBhybrid-plot\fR.
.TP
.BR -p ", " --title =\fIstring
sets the plot title to \fIstring\fR.  Default is "'prefix'" or "'prefix1' vs. 'prefix2'".
.TP
.BR -r ", " --filter
activates the filter.  With the filter enabled, a basepair (i, j) is only plotted if none of the basepairs (i - 1, j), (i - 1, j - 1), (i, j - 1), (i + 1, j), (i + 1, j + 1) or (i, j + 1) has a higher probability than (i, j).
.TP
.BR -o ", " --cutoff =\fIvalue
When a cutoff is set, basepairs with probability less than \fIvalue\fR are not plotted.
.SH REFERENCES
Markham, N. R. and Zuker, M. (2008) UNAFold: software for nucleic acid folding and hybridization.  In Keith, J. M., editor, \fIBioinformatics, Volume II.  Structure, Functions and Applications\fR, number 453 in \fIMethods in Molecular Biology\fR, chapter 1, pages 3-31.  Humana Press, Totowa, NJ.  ISBN 978-1-60327-428-9.
.P
Other references which may be useful may be found at http://dinamelt.bioinfo.rpi.edu/refs.php.
.SH "SEE ALSO"
.BR hybrid (1),
.BR hybrid-ss (1)
.SH AUTHORS
Nick Markham <markhn@rpi.edu> and Michael Zuker <zukerm@rpi.edu>
.SH COPYRIGHT
Copyright (c) 2006-2009, Rensselaer Polytechnic Institute.
.SH AVAILABILITY
UNAFold is available from http://dinamelt.bioinfo.rpi.edu/unafold/.  Commercial use requires a license; see http://dinamelt.bioinfo.rpi.edu/commercial.php.
